#ifndef SF_FACTORIAL_TCC
#define SF_FACTORIAL_TCC 1

#pragma GCC system_header

#include <limits>
#include <cmath>

namespace std
{

// Implementation-space details.
namespace __detail
{

template<typename _Tp>
  struct _Factorial_table
  {
    int __n;
    _Tp __factorial;
    _Tp __log_factorial;
  };

template<typename _Tp>
  constexpr std::size_t _S_num_factorials = 0;

template<>
  constexpr std::size_t _S_num_factorials<float> = 35;
template<>
  constexpr std::size_t _S_num_factorials<double> = 171;
template<>
  constexpr std::size_t _S_num_factorials<long double> = 171;
#ifdef _GLIBCXX_USE_FLOAT128
template<>
  constexpr std::size_t _S_num_factorials<__float128> = 171;
#endif

constexpr _Factorial_table<long double>
_S_factorial_table[171]
{
  {   0,  1.0L,  				     0.0L},
  {   1,  1.0L,  				     0.0L},
  {   2,  2.0L,  				     6.931471805599453094172321214581766e-01L},
  {   3,  6.0L,					     1.791759469228055000812477358380702e+00L},
  {   4,  24.0L,  				     3.178053830347945619646941601297055e+00L},
  {   5,  120.0L,				     4.787491742782045994247700934523243e+00L},
  {   6,  720.0L,				     6.579251212010100995060178292903945e+00L},
  {   7,  5040.0L,				     8.525161361065414300165531036347125e+00L},
  {   8,  40320.0L,				     1.060460290274525022841722740072165e+01L},
  {   9,  362880.0L,				     1.280182748008146961120771787456671e+01L},
  {  10,  3628800.0L,				     1.510441257307551529522570932925107e+01L},
  {  11,  39916800.0L,				     1.750230784587388583928765290721620e+01L},
  {  12,  479001600.0L,				     1.998721449566188614951736238705508e+01L},
  {  13,  6227020800.0L,			     2.255216385312342288557084982862040e+01L},
  {  14,  87178291200.0L,			     2.519122118273868150009343469352175e+01L},
  {  15,  1307674368000.0L,			     2.789927138384089156608943926367047e+01L},
  {  16,  20922789888000.0L,			     3.067186010608067280375836774950317e+01L},
  {  17,  355687428096000.0L,			     3.350507345013688888400790236737630e+01L},
  {  18,  6402373705728000.0L,			     3.639544520803305357621562496267953e+01L},
  {  19,  121645100408832000.0L,		     3.933988418719949403622465239456738e+01L},
  {  20,  2432902008176640000.0L,		     4.233561646075348502965987597070992e+01L},
  {  21,  51090942171709440000.0L,		     4.538013889847690802616047395107563e+01L},
  {  22,  1124000727777607680000.0L,		     4.847118135183522387963964965049893e+01L},
  {  23,  25852016738884976640000.0L,		     5.160667556776437357044640248230913e+01L},
  {  24,  620448401733239439360000.0L,		     5.478472939811231919009334408360618e+01L},
  {  25,  15511210043330985984000000.0L,	     5.800360522298051993929486275005856e+01L},
  {  26,  403291461126605635584000000.0L,	     6.126170176100200198476558231308206e+01L},
  {  27,  10888869450418352160768000000.0L,	     6.455753862700633105895131802384963e+01L},
  {  28,  304888344611713860501504000000.0L,	     6.788974313718153498289113501020917e+01L},
  {  29,  8841761993739701954543616000000.0L,	     7.125703896716800901007440704257107e+01L},
  {  30,  265252859812191058636308480000000.0L,	     7.465823634883016438548764373417796e+01L},
  {  31,  8222838654177922817725562880000000.0L,     7.809222355331531063141680805872032e+01L},
  {  32,  263130836933693530167218012160000000.0L,   8.155795945611503717850296866601120e+01L},
  {  33,  8683317618811886495518194401280000000.0L,  8.505446701758151741396015748089886e+01L},
  {  34,  2.952327990396041408476186096435200e+38L,  8.858082754219767880362692422023016e+01L},
  {  35,  1.033314796638614492966665133752320e+40L,  9.213617560368709248333303629689953e+01L},
  {  36,  3.719933267899012174679994481508352e+41L,  9.571969454214320248495799101366093e+01L},
  {  37,  1.376375309122634504631597958158090e+43L,  9.933061245478742692932608668469238e+01L},
  {  38,  5.230226174666011117600072241000743e+44L,  1.029681986145138126987523462380384e+02L},
  {  39,  2.039788208119744335864028173990290e+46L,  1.066317602606434591262010789165263e+02L},
  {  40,  8.159152832478977343456112695961160e+47L,  1.103206397147573954290535346141270e+02L},
  {  41,  3.345252661316380710817006205344076e+49L,  1.140342117814617032329202979871644e+02L},
  {  42,  1.405006117752879898543142606244512e+51L,  1.177718813997450715388381280889883e+02L},
  {  43,  6.041526306337383563735513206851401e+52L,  1.215330815154386339623109706023341e+02L},
  {  44,  2.658271574788448768043625811014616e+54L,  1.253172711493568951252073784232156e+02L},
  {  45,  1.196222208654801945619631614956577e+56L,  1.291239336391272148825986282302868e+02L},
  {  46,  5.502622159812088949850305428800256e+57L,  1.329525750356163098828226131835552e+02L},
  {  47,  2.586232415111681806429643551536120e+59L,  1.368027226373263684696435638533274e+02L},
  {  48,  1.241391559253607267086228904737338e+61L,  1.406739236482342593987077375760826e+02L},
  {  49,  6.082818640342675608722521633212954e+62L,  1.445657439463448860089184430629690e+02L},
  {  50,  3.041409320171337804361260816606477e+64L,  1.484777669517730320675371938508795e+02L},
  {  51,  1.551118753287382280224243016469303e+66L,  1.524095925844973578391819737056752e+02L},
  {  52,  8.065817517094387857166063685640377e+67L,  1.563608363030787851940699253901568e+02L},
  {  53,  4.274883284060025564298013753389399e+69L,  1.603311282166309070282143945291859e+02L},
  {  54,  2.308436973392413804720927426830276e+71L,  1.643201122631951814118173623614117e+02L},
  {  55,  1.269640335365827592596510084756652e+73L,  1.683274454484276523304800652726030e+02L},
  {  56,  7.109985878048634518540456474637249e+74L,  1.723527971391628015638371143804207e+02L},
  {  57,  4.052691950487721675568060190543232e+76L,  1.763958484069973517152413870492311e+02L},
  {  58,  2.350561331282878571829474910515074e+78L,  1.804562914175437710518418912030512e+02L},
  {  59,  1.386831185456898357379390197203894e+80L,  1.845338288614494905024579415767709e+02L},
  {  60,  8.320987112741390144276341183223363e+81L,  1.886281734236715911872884103898359e+02L},
  {  61,  5.075802138772247988008568121766251e+83L,  1.927390472878449024360397994932615e+02L},
  {  62,  3.146997326038793752565312235495076e+85L,  1.968661816728899939913861959392621e+02L},
  {  63,  1.982608315404440064116146708361898e+87L,  2.010093163992815266792820391565503e+02L},
  {  64,  1.268869321858841641034333893351615e+89L,  2.051681994826411985357854318852994e+02L},
  {  65,  8.247650592082470666723170306785496e+90L,  2.093425867525368356464396786600909e+02L},
  {  66,  5.443449390774430640037292402478427e+92L,  2.135322414945632611913140995964367e+02L},
  {  67,  3.647111091818868528824985909660546e+94L,  2.177369341139542272509841715928004e+02L},
  {  68,  2.480035542436830599600990418569171e+96L,  2.219564418191303339500681704535899e+02L},
  {  69,  1.711224524281413113724683388812728e+98L,  2.261905483237275933322701685223226e+02L},
  {  70,  1.197857166996989179607278372168910e+100L,  2.304390435657769523213935127204502e+02L},
  {  71,  8.504785885678623175211676442399260e+101L,  2.347017234428182677427229672529632e+02L},
  {  72,  6.123445837688608686152407038527467e+103L,  2.389783895618343230537651540911828e+02L},
  {  73,  4.470115461512684340891257138125051e+105L,  2.432688490029827141828572629486213e+02L},
  {  74,  3.307885441519386412259530282212537e+107L,  2.475729140961868839366425907411109e+02L},
  {  75,  2.480914081139539809194647711659403e+109L,  2.518904022097231943772393546444858e+02L},
  {  76,  1.885494701666050254987932260861146e+111L,  2.562211355500095254560828463192901e+02L},
  {  77,  1.451830920282858696340707840863083e+113L,  2.605649409718632093052501426406984e+02L},
  {  78,  1.132428117820629783145752115873204e+115L,  2.649216497985528010421161074406444e+02L},
  {  79,  8.946182130782975286851441715398315e+116L,  2.692910976510198225362890529821258e+02L},
  {  80,  7.156945704626380229481153372318652e+118L,  2.736731242856937041485587408011847e+02L},
  {  81,  5.797126020747367985879734231578109e+120L,  2.780675734403661429141397217488748e+02L},
  {  82,  4.753643337012841748421382069894049e+122L,  2.824742926876303960274237172433704e+02L},
  {  83,  3.945523969720658651189747118012061e+124L,  2.868931332954269939508991894666617e+02L},
  {  84,  3.314240134565353266999387579130131e+126L,  2.913239500942703075662342516899438e+02L},
  {  85,  2.817104114380550276949479442260611e+128L,  2.957666013507606240210845456410431e+02L},
  {  86,  2.422709538367273238176552320344126e+130L,  3.002209486470141317539746202758472e+02L},
  {  87,  2.107757298379527717213600518699389e+132L,  3.046868567656687154725531375451316e+02L},
  {  88,  1.854826422573984391147968456455462e+134L,  3.091641935801469219448667774874712e+02L},
  {  89,  1.650795516090846108121691926245361e+136L,  3.136528299498790617831845930281411e+02L},
  {  90,  1.485715964481761497309522733620825e+138L,  3.181526396202093268499930749566705e+02L},
  {  91,  1.352001527678402962551665687594951e+140L,  3.226634991267261768911519151416790e+02L},
  {  92,  1.243841405464130725547532432587355e+142L,  3.271852877037752172007931322164055e+02L},
  {  93,  1.156772507081641574759205162306240e+144L,  3.317178871969284731381175417778704e+02L},
  {  94,  1.087366156656743080273652852567865e+146L,  3.362611819791984770343557245691008e+02L},
  {  95,  1.032997848823905926259970209939472e+148L,  3.408150588707990178689655113342148e+02L},
  {  96,  9.916779348709496892095714015418933e+149L,  3.453794070622668541074469171784282e+02L},
  {  97,  9.619275968248211985332842594956366e+151L,  3.499541180407702369295636388001322e+02L},
  {  98,  9.426890448883247745626185743057238e+153L,  3.545390855194408088491915764084767e+02L},
  {  99,  9.332621544394415268169923885626665e+155L,  3.591342053695753987760440104602869e+02L},
  { 100,  9.332621544394415268169923885626666e+157L,  3.637393755555634901440799933696556e+02L},
  { 101,  9.425947759838359420851623124482932e+159L,  3.683544960724047495949641916365686e+02L},
  { 102,  9.614466715035126609268655586972591e+161L,  3.729794688856890206760262036128225e+02L},
  { 103,  9.902900716486180407546715254581770e+163L,  3.776141978739186564467948059278759e+02L},
  { 104,  1.029901674514562762384858386476504e+166L,  3.822585887730600291110999897338157e+02L},
  { 105,  1.081396758240290900504101305800329e+168L,  3.869125491232175524822013470474076e+02L},
  { 106,  1.146280563734708354534347384148349e+170L,  3.915759882173296196257630483078949e+02L},
  { 107,  1.226520203196137939351751701038734e+172L,  3.962488170517915257990674471249182e+02L},
  { 108,  1.324641819451828974499891837121832e+174L,  4.009309482789157454920876470786021e+02L},
  { 109,  1.443859583202493582204882102462797e+176L,  4.056222961611448891924649635308113e+02L},
  { 110,  1.588245541522742940425370312709077e+178L,  4.103227765269373054205448985634608e+02L},
  { 111,  1.762952551090244663872161047107075e+180L,  4.150323067282496395563082394714147e+02L},
  { 112,  1.974506857221074023536820372759924e+182L,  4.197508055995447340990825207006906e+02L},
  { 113,  2.231192748659813646596607021218714e+184L,  4.244781934182570746676646521943066e+02L},
  { 114,  2.543559733472187557120132004189334e+186L,  4.292143918666515701284861569845752e+02L},
  { 115,  2.925093693493015690688151804817735e+188L,  4.339593239950148201938936691496116e+02L},
  { 116,  3.393108684451898201198256093588572e+190L,  4.387129141861211848399114054248899e+02L},
  { 117,  3.969937160808720895401959629498629e+192L,  4.434750881209189409587553833403002e+02L},
  { 118,  4.684525849754290656574312362808383e+194L,  4.482457727453846057187886658354781e+02L},
  { 119,  5.574585761207605881323431711741975e+196L,  4.530248962384961351041435531967944e+02L},
  { 120,  6.689502913449127057588118054090371e+198L,  4.578123879812781810983912541313177e+02L},
  { 121,  8.094298525273443739681622845449348e+200L,  4.626081785268749221865151412872479e+02L},
  { 122,  9.875044200833601362411579871448205e+202L,  4.674121995716081787446837625121317e+02L},
  { 123,  1.214630436702532967576624324188129e+205L,  4.722243839269805962399457711220916e+02L},
  { 124,  1.506141741511140879795014161993280e+207L,  4.770446654925856331047093996895503e+02L},
  { 125,  1.882677176888926099743767702491600e+209L,  4.818729792298879342285116776892289e+02L},
  { 126,  2.372173242880046885677147305139416e+211L,  4.867092611368394122258247530279753e+02L},
  { 127,  3.012660018457659544809977077527059e+213L,  4.915534482232980034988721938356916e+02L},
  { 128,  3.856204823625804217356770659234635e+215L,  4.964054784872176206647928186858988e+02L},
  { 129,  4.974504222477287440390234150412680e+217L,  5.012652908915792927796609064361672e+02L},
  { 130,  6.466855489220473672507304395536484e+219L,  5.061328253420348751997323853324169e+02L},
  { 131,  8.471580690878820510984568758152794e+221L,  5.110080226652360267438818093435864e+02L},
  { 132,  1.118248651196004307449963076076169e+224L,  5.158908245878223975981734624013904e+02L},
  { 133,  1.487270706090685728908450891181305e+226L,  5.207811737160441513632878425767215e+02L},
  { 134,  1.992942746161518876737324194182948e+228L,  5.256790135159950627323751466945434e+02L},
  { 135,  2.690472707318050483595387662146980e+230L,  5.305842882944334921811616417385371e+02L},
  { 136,  3.659042881952548657689727220519892e+232L,  5.354969431801695441896628727207848e+02L},
  { 137,  5.012888748274991661034926292112252e+234L,  5.404169241059976691049780628487646e+02L},
  { 138,  6.917786472619488492228198283114908e+236L,  5.453441777911548737965972930389555e+02L},
  { 139,  9.615723196941089004197195613529722e+238L,  5.502786517242855655537860779578311e+02L},
  { 140,  1.346201247571752460587607385894161e+241L,  5.552202941468948698523266542774168e+02L},
  { 141,  1.898143759076170969428526414110767e+243L,  5.601690540372730381305428501841115e+02L},
  { 142,  2.695364137888162776588507508037289e+245L,  5.651248810948742988612895368380828e+02L},
  { 143,  3.854370717180072770521565736493323e+247L,  5.700877257251342061414049678576132e+02L},
  { 144,  5.550293832739304789551054660550385e+249L,  5.750575390247102067618643868172909e+02L},
  { 145,  8.047926057471991944849029257798059e+251L,  5.800342727671307811636484181828790e+02L},
  { 146,  1.174997204390910823947958271638517e+254L,  5.850178793888391176021577591617758e+02L},
  { 147,  1.727245890454638911203498659308619e+256L,  5.900083119756178539037637098855847e+02L},
  { 148,  2.556323917872865588581178015776756e+258L,  5.950055242493819689669662697995324e+02L},
  { 149,  3.808922637630569726985955243507367e+260L,  6.000094705553274281079586980746365e+02L},
  { 150,  5.713383956445854590478932865261050e+262L,  6.050201058494236838579726940994696e+02L},
  { 151,  8.627209774233240431623188626544186e+264L,  6.100373856862386081867689303989541e+02L},
  { 152,  1.311335885683452545606724671234716e+267L,  6.150612662070848845750296541952165e+02L},
  { 153,  2.006343905095682394778288746989116e+269L,  6.200917041284773200380696792869347e+02L},
  { 154,  3.089769613847350887958564670363239e+271L,  6.251286567308909491966542077298012e+02L},
  { 155,  4.789142901463393876335775239063020e+273L,  6.301720818478101958171841313875697e+02L},
  { 156,  7.471062926282894447083809372938311e+275L,  6.352219378550597328634673283089739e+02L},
  { 157,  1.172956879426414428192158071551315e+278L,  6.402781836604080409208917735453774e+02L},
  { 158,  1.853271869493734796543609753051077e+280L,  6.453407786934350077244819512083170e+02L},
  { 159,  2.946702272495038326504339507351213e+282L,  6.504096828956552392500216655842685e+02L},
  { 160,  4.714723635992061322406943211761940e+284L,  6.554848567108890661717085855247856e+02L},
  { 161,  7.590705053947218729075178570936724e+286L,  6.605662610758735291676206911000390e+02L},
  { 162,  1.229694218739449434110178928491749e+289L,  6.656538574111059132426189041691872e+02L},
  { 163,  2.004401576545302577599591653441551e+291L,  6.707476076119126755766838365353080e+02L},
  { 164,  3.287218585534296227263330311644144e+293L,  6.758474740397368739993850641512618e+02L},
  { 165,  5.423910666131588774984495014212838e+295L,  6.809534195136374546094430122993756e+02L},
  { 166,  9.003691705778437366474261723593311e+297L,  6.860654073019939978423357166441252e+02L},
  { 167,  1.503616514864999040201201707840083e+300L,  6.911834011144107529495954674208699e+02L},
  { 168,  2.526075744973198387538018869171339e+302L,  6.963073650938140118743477617656102e+02L},
  { 169,  4.269068009004705274939251888899563e+304L,  7.014372638087370853464547366487408e+02L},
  { 170,  7.257415615307998967396728211129257e+306L,  7.065730622457873471107222627212983e+02L}
};

  /**
   * @brief  Return the factorial of the integer n.
   *
   * The factorial is:
   * @f[
   *   n! = 1 2 ... (n-1) n, 0! = 1
   * @f]
   */
  template<typename _Tp>
    constexpr _Tp
    __factorial(unsigned int __n)
    {
      if (__n < _S_num_factorials<_Tp>)
	return _S_factorial_table[__n].__factorial;
      else
	return std::numeric_limits<_Tp>::infinity();
    }

  /**
   * @brief  Return the logarithm of the factorial of the integer n.
   *
   * The factorial is:
   * @f[
   *   n! = 1 2 ... (n-1) n, 0! = 1
   * @f]
   */
  template<typename _Tp>
    constexpr _Tp
    __log_factorial(unsigned int __n)
    {
      if (__n < _S_num_factorials<_Tp>)
	return _S_factorial_table[__n].__log_factorial;
      //else if (__n < _S_num_double_factorials<_Tp>)
	//return _S_double_factorial_table[__n].__log_factorial
	//     + _S_double_factorial_table[__n - 1].__log_factorial;
      else
	return __log_gamma(_Tp(__n + 1));
    }

} // namespace __detail

} // namespace std

#endif // SF_FACTORIAL_TCC
